<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - DuniaFilm</title>
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-screen">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <h1>üé¨ DuniaFilm</h1>
                    <p>Admin Panel</p>
                </div>
                
                <form id="login-form" class="login-form">
                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" name="username" required 
                               placeholder="Masukkan username">
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" name="password" required 
                               placeholder="Masukkan password">
                    </div>
                    
                    <button type="submit" class="login-btn">
                        <span class="btn-icon">üîê</span> Login
                    </button>
                </form>
                
                <div class="login-footer">
                    <p>Hanya untuk administrator</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Panel (Hidden until login) -->
    <div id="admin-panel" class="admin-panel" style="display: none;">
        <div class="admin-container">
            <!-- Header -->
            <header class="admin-header">
                <div class="header-content">
                    <h1>üé¨ DuniaFilm</h1>
                    <div class="header-info">
                        <span id="update-time"></span>
                        <button class="logout-btn" onclick="logout()">üö™ Logout</button>
                    </div>
                </div>
            </header>

            <!-- Navigation Tabs -->
            <nav class="admin-tabs">
                <button class="tab-btn active" data-tab="dashboard">üìä Dashboard</button>
                <button class="tab-btn" data-tab="add-movie">üì§ Upload Film</button>
                <button class="tab-btn" data-tab="manage-movies">üé¨ Kelola Film</button>
            </nav>

            <!-- Main Content -->
            <main class="admin-content">
                <!-- Dashboard Tab -->
                <div id="dashboard-tab" class="tab-content active">
                    <div class="section-header">
                        <h2>üìä Dashboard Overview</h2>
                    </div>
                    
                    <!-- Statistics -->
                    <div class="stats-section">
                        <div id="stats-container">
                            <div class="loading">Memuat statistik...</div>
                        </div>
                    </div>

                    <!-- Recent Movies -->
                    <div class="recent-movies-section">
                        <h3>üé¨ Film Terbaru</h3>
                        <div id="recent-movies-container" class="recent-movies-grid">
                            <div class="loading">Memuat film terbaru...</div>
                        </div>
                    </div>
                </div>

                <!-- Add Movie Tab -->
                <div id="add-movie-tab" class="tab-content">
                    <div class="section-header">
                        <h2>üì§ Upload Film Baru</h2>
                    </div>
                    
                    <div class="form-container">
                        <form id="movie-form" class="movie-form">
                            <div class="form-grid">
                                <div class="form-column">
                                    <div class="form-group">
                                        <label for="movie-title">üé¨ Judul Film *</label>
                                        <input type="text" id="movie-title" name="title" required 
                                               placeholder="Masukkan judul film">
                                    </div>

                                    <div class="form-group">
                                        <label for="movie-video-url">üîó URL Video *</label>
                                        <div class="input-with-button">
                                            <input type="url" id="movie-video-url" name="video_url" required 
                                                   placeholder="https://example.com/video.mp4">
                                            <button type="button" id="generate-thumbnail-btn" class="generate-thumbnail-btn">
                                                üñºÔ∏è Pilih Thumbnail
                                            </button>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="movie-thumbnail-url">üñºÔ∏è URL Thumbnail</label>
                                        <input type="url" id="movie-thumbnail-url" name="thumbnail_url" 
                                               placeholder="Thumbnail akan digenerate otomatis" readonly>
                                    </div>

                                    <div class="form-group">
                                        <label for="movie-aspect-ratio">üìê Aspect Ratio Thumbnail</label>
                                        <select id="movie-aspect-ratio" name="aspect_ratio">
                                            <option value="16:9">16:9 (Landscape)</option>
                                            <option value="9:16">9:16 (Portrait)</option>
                                            <option value="3:4">3:4 (Portrait)</option>
                                            <option value="4:3">4:3 (Landscape)</option>
                                        </select>
                                        <small>Pilih ukuran thumbnail yang akan ditampilkan</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="movie-category">üìÇ Kategori</label>
                                        <select id="movie-category" name="category">
                                            <option value="colmek">Colmek</option>
                                            <option value="berdua">Berdua</option>
                                            <option value="bergilir">Bergilir</option>
                                            <option value="lainnya" selected>Lainnya</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-column">
                                    <div class="form-group">
                                        <label for="movie-description">üìù Deskripsi</label>
                                        <textarea id="movie-description" name="description" 
                                                  placeholder="Deskripsi film (opsional)" rows="4"></textarea>
                                    </div>

                                    <div class="form-group">
                                        <label for="movie-download-url">üì• URL Download (Opsional)</label>
                                        <input type="url" id="movie-download-url" name="download_url" 
                                               placeholder="https://example.com/download">
                                    </div>

                                    <div class="form-group">
                                        <label>üëÅÔ∏è Preview</label>
                                        <div id="form-preview" class="form-preview">
                                            <div class="preview-placeholder">
                                                <span class="preview-icon">üëÜ</span>
                                                <p>Isi form untuk melihat preview</p>
                                            </div>
                                        </div>
                                    </div>

                                    <button type="submit" class="submit-btn">
                                        <span class="btn-icon">üíæ</span> Simpan Film
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Manage Movies Tab -->
                <div id="manage-movies-tab" class="tab-content">
                    <div class="section-header">
                        <h2>üé¨ Kelola Film</h2>
                        <div class="section-actions">
                            <button id="export-btn" class="export-btn">
                                <span class="btn-icon">üì§</span> Export
                            </button>
                        </div>
                    </div>

                    <!-- Bulk Actions -->
                    <div id="bulk-actions" class="bulk-actions" style="display: none;">
                        <div class="bulk-info">
                            <span id="selected-count">0 film terpilih</span>
                        </div>
                        <div class="bulk-buttons">
                            <button id="bulk-delete-btn" class="bulk-delete-btn">
                                <span class="btn-icon">üóëÔ∏è</span> Hapus
                            </button>
                        </div>
                    </div>

                    <!-- Filters and Search -->
                    <div class="management-tools">
                        <div class="search-box">
                            <input type="text" id="admin-search" placeholder="Cari judul atau deskripsi...">
                            <button id="admin-search-btn" class="search-btn">
                                <span class="btn-icon">üîç</span>
                            </button>
                        </div>
                        
                        <div class="filter-group">
                            <select id="category-filter">
                                <option value="all">Semua Kategori</option>
                                <option value="colmek">Colmek</option>
                                <option value="berdua">Berdua</option>
                                <option value="bergilir">Bergilir</option>
                                <option value="lainnya">Lainnya</option>
                            </select>
                        </div>

                        <div class="count-display">
                            <span id="display-count">0</span> dari <span id="total-count">0</span>
                        </div>
                    </div>

                    <!-- Movies Table -->
                    <div class="movies-table-container">
                        <table class="movies-table">
                            <thead>
                                <tr>
                                    <th class="checkbox-cell">
                                        <input type="checkbox" id="select-all" onchange="selectAllMovies(this.checked)">
                                    </th>
                                    <th class="thumbnail-cell">Thumbnail</th>
                                    <th class="title-cell">Judul Film</th>
                                    <th class="category-cell">Kategori</th>
                                    <th class="aspect-ratio-cell">Aspect Ratio</th>
                                    <th class="views-cell">Views</th>
                                    <th class="date-cell">Tanggal</th>
                                    <th class="actions-cell">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="movies-table-body">
                                <tr>
                                    <td colspan="8" class="loading">
                                        <div class="loading-spinner"></div>
                                        Memuat data film...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Table Summary -->
                    <div class="table-summary">
                        <div class="summary-item">
                            <span class="summary-label">Total Film:</span>
                            <span id="total-movies" class="summary-value">0</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Total Views:</span>
                            <span id="total-views" class="summary-value">0</span>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Thumbnail Picker Modal -->
        <div id="thumbnail-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üñºÔ∏è Pilih Thumbnail dari Video</h3>
                    <button id="close-thumbnail-modal" class="close-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="video-preview-section">
                        <div id="thumbnail-video-container" class="video-container">
                            <!-- Video element will be inserted here -->
                        </div>
                        <div class="video-controls">
                            <div class="seek-control">
                                <label>Geser untuk memilih frame:</label>
                                <input type="range" id="thumbnail-seek-bar" class="seek-bar" 
                                       min="0" max="100" value="10" step="1">
                                <span id="current-time" class="time-display">00:00</span>
                            </div>
                            <div class="aspect-ratio-control">
                                <label for="thumbnail-aspect-ratio">Pilih Rasio Thumbnail:</label>
                                <select id="thumbnail-aspect-ratio">
                                    <option value="16:9">16:9 (Landscape)</option>
                                    <option value="9:16">9:16 (Portrait)</option>
                                    <option value="3:4">3:4 (Portrait)</option>
                                    <option value="4:3">4:3 (Landscape)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="thumbnail-preview-section">
                        <h4>Preview Thumbnail</h4>
                        <div id="thumbnail-preview" class="thumbnail-preview">
                            <div class="preview-placeholder">
                                <span class="preview-icon">üé¨</span>
                                <p>Geser seek bar untuk melihat preview</p>
                            </div>
                        </div>
                        <div class="modal-actions">
                            <button id="confirm-thumbnail" class="confirm-btn">
                                ‚úÖ Gunakan Thumbnail
                            </button>
                            <button id="cancel-thumbnail" class="cancel-btn">
                                ‚ùå Batal
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p>Memuat...</p>
    </div>

    <script>
        // Check if already logged in
        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem('adminLoggedIn') === 'true';
            const loginScreen = document.getElementById('login-screen');
            const adminPanel = document.getElementById('admin-panel');
            
            if (isLoggedIn) {
                if (loginScreen) loginScreen.style.display = 'none';
                if (adminPanel) adminPanel.style.display = 'block';
            } else {
                if (loginScreen) loginScreen.style.display = 'block';
                if (adminPanel) adminPanel.style.display = 'none';
            }
        }

        // Handle login form submission
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const submitBtn = this.querySelector('.login-btn');
            
            // Show loading
            document.getElementById('loading-overlay').style.display = 'flex';
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="btn-icon">‚è≥</span> Memproses...';
            
            // Simulate login process
            setTimeout(() => {
                // Hardcoded credentials for demo
                if (username === 'admin' && password === 'admin123') {
                    localStorage.setItem('adminLoggedIn', 'true');
                    checkLoginStatus();
                } else {
                    alert('Username atau password salah!');
                }
                
                document.getElementById('loading-overlay').style.display = 'none';
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<span class="btn-icon">üîê</span> Login';
            }, 1000);
        });

        // Logout function
        function logout() {
            if (confirm('Apakah Anda yakin ingin logout?')) {
                localStorage.removeItem('adminLoggedIn');
                checkLoginStatus();
            }
        }

        // Check login status on page load
        document.addEventListener('DOMContentLoaded', checkLoginStatus);
    </script>
    
    <!-- Load admin.js sebagai module -->
    <script type="module" src="admin.js"></script>
</body>
</html>